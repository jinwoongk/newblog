"use strict";(self.webpackChunkddii=self.webpackChunkddii||[]).push([[5590],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return d}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),c=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=c(n),d=a,g=m["".concat(o,".").concat(d)]||m[d]||u[d]||i;return n?r.createElement(g,s(s({ref:t},p),{},{components:n})):r.createElement(g,s({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,s=new Array(i);s[0]=m;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var c=2;c<i;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},45938:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return o},default:function(){return d},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var r=n(87462),a=n(63366),i=(n(67294),n(3905)),s=["components"],l={layout:"single",title:"git-sync",comments:!0,classes:"wide",description:"git-sync\uc5d0 \ub300\ud574\uc11c \uc54c\uc544\ubcf8\ub2e4.",slug:"kubernetes/git-sync/",date:new Date("2019-03-21T00:00:00.000Z"),categories:["Kubernetes"],tags:["git-sync","GitOps","Kubernetes","ssh git","sidecar","sidecar pattern"]},o=void 0,c={permalink:"/kubernetes/git-sync/",editUrl:"https://github.com/ddiiwoong/newblog/tree/main/blog/2019-03-21-git-sync.md",source:"@site/blog/2019-03-21-git-sync.md",title:"git-sync",description:"git-sync\uc5d0 \ub300\ud574\uc11c \uc54c\uc544\ubcf8\ub2e4.",date:"2019-03-21T00:00:00.000Z",formattedDate:"March 21, 2019",tags:[{label:"git-sync",permalink:"/tags/git-sync"},{label:"GitOps",permalink:"/tags/git-ops"},{label:"Kubernetes",permalink:"/tags/kubernetes"},{label:"ssh git",permalink:"/tags/ssh-git"},{label:"sidecar",permalink:"/tags/sidecar"},{label:"sidecar pattern",permalink:"/tags/sidecar-pattern"}],readingTime:8.095,truncated:!1,authors:[],frontMatter:{layout:"single",title:"git-sync",comments:!0,classes:"wide",description:"git-sync\uc5d0 \ub300\ud574\uc11c \uc54c\uc544\ubcf8\ub2e4.",slug:"kubernetes/git-sync/",date:"2019-03-21T00:00:00.000Z",categories:["Kubernetes"],tags:["git-sync","GitOps","Kubernetes","ssh git","sidecar","sidecar pattern"]},prevItem:{title:"eksworkshop",permalink:"/kubernetes/eksworkshop/"},nextItem:{title:"VScode Server",permalink:"/tools/vscode-server/"}},p={authorsImageUrls:[]},u=[{value:"git-sync",id:"git-sync",level:2},{value:"GitHub SSH\uc124\uc815",id:"github-ssh\uc124\uc815",level:2},{value:"\uae30\uc874\uc5d0 \ub4f1\ub85d\ub41c SSH key \ud655\uc778",id:"\uae30\uc874\uc5d0-\ub4f1\ub85d\ub41c-ssh-key-\ud655\uc778",level:3},{value:"\uc0c8\ub85c\uc6b4 SSH key \uc0dd\uc131",id:"\uc0c8\ub85c\uc6b4-ssh-key-\uc0dd\uc131",level:3},{value:"ssh agent \uc2e4\ud589\uc911\uc778\uc9c0 \ud655\uc778",id:"ssh-agent-\uc2e4\ud589\uc911\uc778\uc9c0-\ud655\uc778",level:3},{value:"\uc0dd\uc131\ub41c \ud0a4\ub97c keychain\uc5d0 \uc800\uc7a5 \ubc0f \ud655\uc778",id:"\uc0dd\uc131\ub41c-\ud0a4\ub97c-keychain\uc5d0-\uc800\uc7a5-\ubc0f-\ud655\uc778",level:3},{value:"\ubcf5\uc0ac \ubc0f github\uc5d0 \ucd94\uac00",id:"\ubcf5\uc0ac-\ubc0f-github\uc5d0-\ucd94\uac00",level:3},{value:"\ud130\ubbf8\ub110\uc5d0\uc11c SSH\uc811\uc18d \ud655\uc778",id:"\ud130\ubbf8\ub110\uc5d0\uc11c-ssh\uc811\uc18d-\ud655\uc778",level:3},{value:"git-sync\ub97c \uc704\ud55c secret \ub4f1\ub85d",id:"git-sync\ub97c-\uc704\ud55c-secret-\ub4f1\ub85d",level:2},{value:"secret \uc0dd\uc131",id:"secret-\uc0dd\uc131",level:3},{value:"sample ngnix \ubc30\ud3ec",id:"sample-ngnix-\ubc30\ud3ec",level:2},{value:"git-sync-demo.yaml \uc791\uc131",id:"git-sync-demoyaml-\uc791\uc131",level:3},{value:"\ud655\uc778\uc0ac\ud56d",id:"\ud655\uc778\uc0ac\ud56d",level:3},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:2}],m={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,s);return(0,i.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"git repo\ub97c kubernetes volume\uc73c\ub85c \uad6c\ud604\ud560\uc218 \uc788\ub294 sidecar pattern ",(0,i.kt)("inlineCode",{parentName:"p"},"git-sync")," \ud504\ub85c\uc81d\ud2b8\uc5d0 \ub300\ud574\uc11c \uc54c\uc544\ubcf8\ub2e4."),(0,i.kt)("h2",{id:"git-sync"},"git-sync"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/kubernetes"},"Kubernetes Github"),"\uc5d0 \ubc29\ubb38\ud558\uba74 \ub2e4\uc591\ud55c \ud504\ub85c\uc81d\ud2b8\ub4e4\uc744 \ubcfc \uc218 \uc788\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/kubernetes"},"Kubernetes Project"),"\ubd80\ud130 minikube, kubeadm, kubectl, kubelet, dashboard\ub4f1 \ud544\uc218\uc801\uc73c\ub85c \ud544\uc694\ud558\uac70\ub098 \ub9ce\uc774 \uc0ac\uc6a9\ub418\ub294 \ud504\ub85c\uc81d\ud2b8\ub97c \ubcfc \uc218 \uc788\ub294\ub370,\n\uae30\uc874\uc5d0 storage volume \uc73c\ub85c \ud65c\uc6a9\ub418\ub358 ",(0,i.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/storage/volumes/#gitrepo"},"gitrepo"),"\uac00 ",(0,i.kt)("inlineCode",{parentName:"p"},"deprecated")," \ub418\uc5b4\uc11c \ubc29\ubc95\uc744 \ucc3e\ub2e4\uac00 \uc720\uc0ac\ud55c \ud504\ub85c\uc81d\ud2b8\ub97c \uacf5\uc2dd repo\uc5d0\uc11c \uc6b0\uc5f0\ud788 \ubc1c\uacac\ud558\uac8c \ub418\uc5c8\ub2e4.  "),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/git-sync"},"git-sync"),"\ub294 sidecar \ubc29\uc2dd\uc73c\ub85c git repository\ub97c clone\ud558\ub294 \ud504\ub85c\uc81d\ud2b8\uc774\ub2e4.  "),(0,i.kt)("p",null,"\ucd5c\ucd08 \ud55c\ubc88 clone\ub3c4 \uac00\ub2a5\ud558\uace0 \uc77c\uc815\ud55c \uac04\uaca9\uc73c\ub85c \ub04c\uc5b4\uc640\uc11c \uc751\uc6a9\ud504\ub85c\uadf8\ub7a8\uc5d0 \uc0ac\uc6a9\ud560 \uc218 \uc788\uace0 \uc6d0\ud558\ub294 branch, Tag \ub610\ub294 \ud2b9\uc815 git hash \uae30\ubc18\uc73c\ub85c pulling\uc774 \uac00\ub2a5\ud558\ub2e4.  "),(0,i.kt)("p",null,"upstream\uc758 repository\uc5d0\uc11c \ub300\uc0c1\uc774 \ubcc0\uacbd\ub418\uc5c8\uc744\ub54c \ub2e4\uc2dc pulling\ud558\uace0, webhook\uae30\ub2a5\uc744 \ucd94\uac00\ud558\uc5ec \ube44\ub3d9\uae30\uc131\uc73c\ub85c POST \uc694\uccad\uc774 \uc788\uc744\ub54c\ub9cc git-sync\ub97c \uc218\ud589\ud560\uc218 \uc788\uae30 \ub54c\ubb38\uc5d0\nContinuous Deployment\ub97c \uac04\ub2e8\ud558\uac8c \uad6c\ud604\ud558\ub294\ub370 \ud65c\uc6a9\ub420 \uc218 \uc788\ub2e4. "),(0,i.kt)("h2",{id:"github-ssh\uc124\uc815"},"GitHub SSH\uc124\uc815"),(0,i.kt)("p",null,"git \ub0b4\uc6a9\uc744 pulling\uc744 \ud560\ub54c https, ssh \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud558\ub294\ub370 GitHub ssh key\ub97c kubernetes cluster\uc758 secret\uc73c\ub85c \uc0ac\uc6a9\uc744 \ud560\uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 ssh \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud558\ub294 \ubc29\ubc95\uc744 \uc791\uc131\ud558\uc600\ub2e4.  "),(0,i.kt)("p",null,"\uc544\ub798 \ubaa8\ub4e0 \uacfc\uc815\uc740 MacOS\uc5d0\uc11c \uc9c4\ud589\ud558\uc600\uace0 \ub2e4\ub978 OS\ub294 \uc544\ub798 \ub9c1\ud06c\uc5d0\uc11c \ud655\uc778 \uac00\ub2a5\ud558\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("a",{parentName:"p",href:"https://help.github.com/en/articles/connecting-to-github-with-ssh"},"https://help.github.com/en/articles/connecting-to-github-with-ssh")),(0,i.kt)("p",null,"\uc0ac\uc6a9\ud558\uace0\uc790 \ud558\ub294 \ud130\ubbf8\ub110\uc5d0\uc11c \ub4f1\ub85d\ud0a4\ub97c \ud655\uc778\ud558\uc790."),(0,i.kt)("h3",{id:"\uae30\uc874\uc5d0-\ub4f1\ub85d\ub41c-ssh-key-\ud655\uc778"},"\uae30\uc874\uc5d0 \ub4f1\ub85d\ub41c SSH key \ud655\uc778"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ls -al ~/.ssh\n")),(0,i.kt)("h3",{id:"\uc0c8\ub85c\uc6b4-ssh-key-\uc0dd\uc131"},"\uc0c8\ub85c\uc6b4 SSH key \uc0dd\uc131"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ssh-keygen -t rsa -b 4096 -C \"ddiiwoong@gmail.com\"\n# Start the SSH key creation process\n> Enter file in which the key is (/Users/you/.ssh/id_rsa): [Hit enter]\n> Key has comment '/Users/you/.ssh/id_rsa'\n> Enter new passphrase (empty for no passphrase): [Type new passphrase]\n> Enter same passphrase again: [One more time for luck]\n> Your identification has been saved with the new passphrase.\n")),(0,i.kt)("h3",{id:"ssh-agent-\uc2e4\ud589\uc911\uc778\uc9c0-\ud655\uc778"},"ssh agent \uc2e4\ud589\uc911\uc778\uc9c0 \ud655\uc778"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"eval \u201c$(ssh-agent -s)\u201d\n> Agent pid 59566\n")),(0,i.kt)("h3",{id:"\uc0dd\uc131\ub41c-\ud0a4\ub97c-keychain\uc5d0-\uc800\uc7a5-\ubc0f-\ud655\uc778"},"\uc0dd\uc131\ub41c \ud0a4\ub97c keychain\uc5d0 \uc800\uc7a5 \ubc0f \ud655\uc778"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ssh-add -K ~/.ssh/id_rsa\n$ cat ~/.ssh/id_rsa.pub\n")),(0,i.kt)("h3",{id:"\ubcf5\uc0ac-\ubc0f-github\uc5d0-\ucd94\uac00"},"\ubcf5\uc0ac \ubc0f github\uc5d0 \ucd94\uac00"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ pbcopy < ~/.ssh/id_rsa.pub\n")),(0,i.kt)("p",null,"Setting - SSH and GPG keys - SSH keys - New SSH key",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"Title"),"\uc740 \uad6c\ubd84\uc790\ub85c \uc785\ub825\ud558\uace0 GitHub password\ub97c \ud55c\ubc88\ub354 \uc785\ub825\ud558\uace0 \uc644\ub8cc\ud55c\ub2e4.  "),(0,i.kt)("h3",{id:"\ud130\ubbf8\ub110\uc5d0\uc11c-ssh\uc811\uc18d-\ud655\uc778"},"\ud130\ubbf8\ub110\uc5d0\uc11c SSH\uc811\uc18d \ud655\uc778"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ssh -T git@github.com\nHi ddiiwoong! You've successfully authenticated, but GitHub does not provide shell access.\n")),(0,i.kt)("h2",{id:"git-sync\ub97c-\uc704\ud55c-secret-\ub4f1\ub85d"},"git-sync\ub97c \uc704\ud55c secret \ub4f1\ub85d"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/git-sync/blob/master/docs/ssh.md"},"https://github.com/kubernetes/git-sync/blob/master/docs/ssh.md")),(0,i.kt)("h3",{id:"secret-\uc0dd\uc131"},"secret \uc0dd\uc131"),(0,i.kt)("p",null,"\uc704\uc5d0\uc11c \uc0dd\uc131\ud55c SSH key\ub97c Kubernetes Cluster\uc5d0 Secret resource\ub85c \uc800\uc7a5\uc744 \ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ssh-keyscan github.com > /tmp/known_hosts\n# github.com:22 SSH-2.0-babeld-9d924d26\n# github.com:22 SSH-2.0-babeld-9d924d26\n# github.com:22 SSH-2.0-babeld-9d924d26\n")),(0,i.kt)("p",null,"known_hosts\uc640 key\ub97c Secret\uc73c\ub85c \uc800\uc7a5\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ kubectl create secret generic git-creds \\\n    --from-file=ssh=$HOME/.ssh/id_rsa \\\n    --from-file=known_hosts=/tmp/known_hosts\n\n$ kubectl get secret git-creds\nNAME        TYPE      DATA      AGE\ngit-creds   Opaque    2         1d\n")),(0,i.kt)("h2",{id:"sample-ngnix-\ubc30\ud3ec"},"sample ngnix \ubc30\ud3ec"),(0,i.kt)("p",null,"\uae30\ubcf8\uc801\uc73c\ub85c ",(0,i.kt)("inlineCode",{parentName:"p"},"git-sync/cmd/git-sync/main.go")," \uc18c\uc2a4\ub97c \ud655\uc778\ud558\uba74 \uc5ec\ub7ec\uac00\uc9c0 flag\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub294\ub370 \uc8fc\ub85c \uc0ac\uc6a9\ud558\ub294 \uc635\uc158\uc740 \ub2e4\uc74c\uacfc \uac19\ub2e4."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"ssh : pulling \ubc29\uc2dd (default=false)"),(0,i.kt)("li",{parentName:"ul"},'root : git clone\uc774 \uc218\ud589\ub418\ub294 root directory (default="$HOME/git")'),(0,i.kt)("li",{parentName:"ul"},'repo : clone \ub300\uc0c1 Repository (default="")'),(0,i.kt)("li",{parentName:"ul"},"branch : branch (default=master)"),(0,i.kt)("li",{parentName:"ul"},"rev : git revision (tag or hash) to check out"),(0,i.kt)("li",{parentName:"ul"},"depth : commit depth (default=0)"),(0,i.kt)("li",{parentName:"ul"},"dest : repository \ubc30\ud3ec directory")),(0,i.kt)("p",null,"\uae30\ud0c0 \uc635\uc158\ub4e4\uc740 ",(0,i.kt)("inlineCode",{parentName:"p"},"git-sync/cmd/git-sync/main.go")," \uc5d0\uc11c \ud655\uc778\uc774 \uac00\ub2a5\ud558\uba70 \ud574\ub2f9 \uc635\uc158\ub4e4\uc744 \ubcc0\uc218\ub85c \ucc98\ub9ac\ud558\uc5ec \ud65c\uc6a9\ud558\uba74 \ub41c\ub2e4."),(0,i.kt)("h3",{id:"git-sync-demoyaml-\uc791\uc131"},"git-sync-demo.yaml \uc791\uc131"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'apiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  labels:\n    app: git-sync-demo\n  name: git-sync-demo\n  namespace: default\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: git-sync-demo\n  template:\n    metadata:\n      labels:\n        app: git-sync-demo\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.14-alpine\n        ports:\n        - containerPort: 80\n        volumeMounts:\n        - name: git-sync-volume\n          mountPath: /usr/share/nginx\n      - name: git-sync\n        image: k8s.gcr.io/git-sync:v3.1.1\n        imagePullPolicy: Always\n        args:\n         - "-ssh"\n         - "-repo=git@github.com:ddiiwoong/git-sync-demo.git"\n         - "-root=/usr/share/nginx"\n         - "-dest=html"\n         - "-branch=master"\n         - "-depth=1"\n        volumeMounts:\n        - name: git-sync-volume\n          mountPath: /usr/share/nginx\n        - name: git-secret\n          mountPath: /etc/git-secret\n      volumes:\n      - name: git-sync-volume\n        emptyDir: {}\n      - name: git-secret\n        secret:\n          secretName: git-creds\n          defaultMode: 288 # = mode 0440\n      securityContext:\n        fsGroup: 65533 # to make SSH key readable\n---\nkind: Service\napiVersion: v1\nmetadata:\n  name: git-sync-demo\nspec:\n  type: NodePort\n  selector:\n    app: git-sync-demo\n  ports:\n  - protocol: TCP\n    port: 80\n    targetPort: 80\n')),(0,i.kt)("h3",{id:"\ud655\uc778\uc0ac\ud56d"},"\ud655\uc778\uc0ac\ud56d"),(0,i.kt)("p",null,"\uc77c\ub2e8 ngnix\ub85c 1.14-alpine Image\ub97c \uae30\ubcf8\uc73c\ub85c \ud558\uace0 git-sync container\uac00 sidecar\ub85c \ub4e4\uc5b4\uac00\ub3c4\ub85d \uc791\uc131\ud558\uc600\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uc2e4\uc81c \ub3d9\uc791\ud558\ub294 \uc21c\uc11c\ub300\ub85c manifest\ub97c \uc544\ub798\uc11c\ubd80\ud130 \uc0b4\ud3b4\ubcf4\uc790."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"git-sync-volume\uc740 ",(0,i.kt)("inlineCode",{parentName:"li"},"emptyDir"),", git-secret\uc740 ",(0,i.kt)("inlineCode",{parentName:"li"},"secret")," volume \uc124\uc815",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"...\n    volumes:\n    - name: git-sync-volume\n      emptyDir: {}\n    - name: git-secret\n      secret:\n        secretName: git-creds\n        defaultMode: 288 # = mode 0440\n...\n"))),(0,i.kt)("li",{parentName:"ul"},"sidecar container image\ub97c ",(0,i.kt)("inlineCode",{parentName:"li"},"k8s.gcr.io/git-sync:v3.1.1"),"\ub85c \uc124\uc815"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"git-sync-volume"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"git-sync-volume")," volume\uc744 ",(0,i.kt)("inlineCode",{parentName:"li"},"git-sync")," sidecar\uc5d0 \ub9c8\uc6b4\ud2b8"),(0,i.kt)("li",{parentName:"ul"},"\uc704\uc5d0\uc11c \uc774\uc57c\uae30\ud55c ",(0,i.kt)("inlineCode",{parentName:"li"},"git-sync")," flag, args\ub85c \uc124\uc815",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},'...\n    containers:\n    - name: git-sync\n      image: k8s.gcr.io/git-sync:v3.1.1\n      imagePullPolicy: Always\n      args:\n       - "-ssh"\n       - "-repo=git@github.com:ddiiwoong/git-sync-demo.git"\n       - "-root=/usr/share/nginx"\n       - "-dest=html"\n       - "-branch=master"\n       - "-depth=1"\n      volumeMounts:\n      - name: git-sync-volume\n        mountPath: /usr/share/nginx\n      - name: git-secret\n        mountPath: /etc/git-secret\n...\n'))),(0,i.kt)("li",{parentName:"ul"},"nginx \uae30\ubcf8 \uc704\uce58\uac00 ",(0,i.kt)("inlineCode",{parentName:"li"},"/usr/share/nginx")," \uc774\ubbc0\ub85c mount \uc704\uce58\ub97c git-sync-volume\uc73c\ub85c \uc124\uc815",(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"...\n  spec:\n    containers:\n    - name: nginx\n      image: nginx:1.14-alpine\n      ports:\n      - containerPort: 80\n      volumeMounts:\n      - name: git-sync-volume\n        mountPath: /usr/share/nginx\n...\n")))),(0,i.kt)("p",null,"\uc704 nginx\ub97c \ubc30\ud3ec\ud558\uace0 \uc811\uc18d\ud558\uba74 ",(0,i.kt)("inlineCode",{parentName:"p"},"Hello git-sync demo v1.0"),"\ub97c \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("p",null,"\uacb0\uad6d git repo code (static html page)\ub294 ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/share/nginx/html")," \uc704\uce58\uc5d0 clone \ub418\ub294\uac83\ucc98\ub7fc \ubcf4\uc774\uc9c0\ub9cc\n\uc2e4\uc81c clone \uc704\uce58\ub97c \ud655\uc778\ud574\ubcf4\uba74 symbolic link\ub85c \ud2b9\uc815 revision dir\ub97c \uac00\ub9ac\ud0a4\uace0 \uc788\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ kubectl exec -it git-sync-demo-665c9c9ddf-6nwc4 sh\nDefaulting container name to nginx.\nUse 'kubectl describe pod/git-sync-demo-665c9c9ddf-6nwc4 -n default' to see all of the containers in this pod.\n/ # cd /usr/share/nginx/\n/usr/share/nginx # ls -al\ntotal 16\ndrwxrwsrwx    4 root     nogroup       4096 Mar 21 06:54 .\ndrwxr-xr-x    1 root     root          4096 Mar  8 03:09 ..\ndrwxr-sr-x    9 65533    nogroup       4096 Mar 21 06:54 .git\nlrwxrwxrwx    1 65533    nogroup         44 Mar 21 06:54 html -> rev-07aa36f719091d75b5665203fa5846a549e7d540\ndrwxr-sr-x    2 65533    nogroup       4096 Mar 21 06:54 rev-07aa36f719091d75b5665203fa5846a549e7d540\n/usr/share/nginx # cat ./html/index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Hello git-sync demo</title>\n  </head>\n  <body>\n    <h1>Hello git-sync demo v1.0</h1>\n  </body>\n</html>\n")),(0,i.kt)("p",null,"github\uc5d0 \uc788\ub294 \uc704 index.html \ub0b4\uc6a9\uc744 \uc218\uc815\ud558\uace0 commit\uc744 \ud558\uac8c \ub418\uba74 \uc2e4\uc2dc\uac04\uc73c\ub85c \uc544\ub798\uc640 \uac19\uc774 revision \uc815\ubcf4 \ubc0f \ub0b4\uc6a9\uc774 \ubc14\ub010\uac83\uc744 \ud655\uc778\ud560\uc218 \uc788\ub2e4.  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"/usr/share/nginx # ls -al\ntotal 16\ndrwxrwsrwx    4 root     nogroup       4096 Mar 21 13:40 .\ndrwxr-xr-x    1 root     root          4096 Mar  8 03:09 ..\ndrwxr-sr-x    9 65533    nogroup       4096 Mar 21 13:40 .git\nlrwxrwxrwx    1 65533    nogroup         44 Mar 21 13:40 html -> rev-b125908649135856d79c515c17decba68797a6cb\ndrwxr-sr-x    2 65533    nogroup       4096 Mar 21 13:40 rev-b125908649135856d79c515c17decba68797a6cb\n/usr/share/nginx # cat ./html/index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Hello git-sync demo</title>\n  </head>\n  <body>\n    <h1>Hello git-sync demo v1.1</h1>\n  </body>\n</html>\n")),(0,i.kt)("h2",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,i.kt)("p",null,"git-sync\ub97c \uac04\ub2e8\ud558\uac8c \ud14c\uc2a4\ud2b8\ud574\ubd24\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uac04\ub2e8\ud558\uac8c ",(0,i.kt)("inlineCode",{parentName:"p"},"sidecar")," \ubc29\uc2dd\uc758 clone tool\ub85c\uc11c ",(0,i.kt)("inlineCode",{parentName:"p"},"git-sync"),"\ub97c \ud65c\uc6a9\ud558\uba74 \uc5ec\ub7ec\uac00\uc9c0\ub85c \ucda9\ubd84\ud788 \ud65c\uc6a9\uc774 \uac00\ub2a5\ud560 \uac83\uc774\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\ud3ec\uc2a4\ud305\uc744 \uc791\uc131\ud558\uba74\uc11c \ub5a0\uc624\ub978 \ud65c\uc6a9\uc6a9\ub3c4\ub97c \uc815\ub9ac\ud558\uba74 \uc544\ub798\uc640 \uac19\ub2e4. \uc5b4\ucc0c\ubcf4\uba74 sidecar pattern\uc758 \ud65c\uc6a9\ubc29\uc548\uc774\ub77c\uace0\ub3c4 \ubcfc\uc218 \uc788\ub2e4."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"CDN\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uace0 git\uc5d0\uc11c \uc18c\uaddc\ubaa8\ub85c \ucee8\ud150\uce20\ub97c \uac00\uc838\uc62c\ub54c"),(0,i.kt)("li",{parentName:"ul"},"DBMS\uac00 \ud544\uc694\uc5c6\uc744 \uc815\ub3c4\uc758 \uc801\uc740 \ub370\uc774\ud130\ub97c \uac00\uc838\uc62c\ub54c"),(0,i.kt)("li",{parentName:"ul"},"jekyll\uc774\ub098 hugo \uac19\uc740 \uc815\uc801 \uc0ac\uc774\ud2b8(\ube14\ub85c\uadf8)\uc758 sidecar \ud328\ud134 (GitPage\ucc98\ub7fc markdown\uc744 \ucd94\uac00\ud558\uace0 git commit\ud558\uba74 \ubc14\ub85c \uc0ac\uc774\ud2b8\uc5d0 \ubc18\uc601\ub418\ub294 \ubc29\uc2dd)"),(0,i.kt)("li",{parentName:"ul"},"nginx, haproxy, apache\uc640 \uac19\uc774 config \ubcc0\uacbd\uc774 \ud544\uc694\ud560\ub54c webhook\ubc29\uc2dd\uc73c\ub85c \uc124\uc815\uc744 \ubcc0\uacbd\ud55c\ud6c4 pod\ub97c \uc7ac\uae30\ub3d9\ud558\ub294 GitOps \uad6c\ud604")))}d.isMDXComponent=!0}}]);