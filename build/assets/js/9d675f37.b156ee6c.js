"use strict";(self.webpackChunkddii=self.webpackChunkddii||[]).push([[1755],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return k}});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var o=r.createContext({}),l=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},u=function(e){var n=l(e.components);return r.createElement(o.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),d=l(t),k=a,b=d["".concat(o,".").concat(k)]||d[k]||p[k]||i;return t?r.createElement(b,s(s({ref:n},u),{},{components:t})):r.createElement(b,s({ref:n},u))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=d;var c={};for(var o in n)hasOwnProperty.call(n,o)&&(c[o]=n[o]);c.originalType=e,c.mdxType="string"==typeof e?e:a,s[1]=c;for(var l=2;l<i;l++)s[l]=t[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},31104:function(e,n,t){t.r(n),t.d(n,{assets:function(){return u},contentTitle:function(){return o},default:function(){return k},frontMatter:function(){return c},metadata:function(){return l},toc:function(){return p}});var r=t(87462),a=t(63366),i=(t(67294),t(3905)),s=["components"],c={layout:"single",title:"Dex",comments:!0,classes:"wide",description:"Dex \ub300\ud574 \uc54c\uc544\ubd05\ub2c8\ub2e4",slug:"kubernetes/dex/",date:new Date("2018-07-26T00:00:00.000Z"),categories:["Kubernetes"],tags:["dex","Kubernetes","identity service","OIDC","connectors"]},o=void 0,l={permalink:"/kubernetes/dex/",editUrl:"https://github.com/ddiiwoong/newblog/tree/main/blog/2018-07-26-dex.md",source:"@site/blog/2018-07-26-dex.md",title:"Dex",description:"Dex \ub300\ud574 \uc54c\uc544\ubd05\ub2c8\ub2e4",date:"2018-07-26T00:00:00.000Z",formattedDate:"July 26, 2018",tags:[{label:"dex",permalink:"/tags/dex"},{label:"Kubernetes",permalink:"/tags/kubernetes"},{label:"identity service",permalink:"/tags/identity-service"},{label:"OIDC",permalink:"/tags/oidc"},{label:"connectors",permalink:"/tags/connectors"}],readingTime:9.39,truncated:!1,authors:[],frontMatter:{layout:"single",title:"Dex",comments:!0,classes:"wide",description:"Dex \ub300\ud574 \uc54c\uc544\ubd05\ub2c8\ub2e4",slug:"kubernetes/dex/",date:"2018-07-26T00:00:00.000Z",categories:["Kubernetes"],tags:["dex","Kubernetes","identity service","OIDC","connectors"]},prevItem:{title:"knative",permalink:"/kubernetes/knative/"},nextItem:{title:"Cert-manager",permalink:"/kubernetes/cert-manager/"}},u={authorsImageUrls:[]},p=[{value:"Dex - A federated OpenID Connect provider",id:"dex---a-federated-openid-connect-provider",level:2},{value:"dex\ub294 \uae30\ubcf8\uc801\uc73c\ub85c OpenID Connect\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2e4\ub978 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758 \uc778\uc99d\uc744 \ud558\uac8c \ud574\uc8fc\ub294 identity \uc11c\ube44\uc2a4\ub2e4.",id:"dex\ub294-\uae30\ubcf8\uc801\uc73c\ub85c-openid-connect\ub97c-\uc0ac\uc6a9\ud558\uc5ec-\ub2e4\ub978-\uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758-\uc778\uc99d\uc744-\ud558\uac8c-\ud574\uc8fc\ub294-identity-\uc11c\ube44\uc2a4\ub2e4",level:3},{value:"OpenID Connect",id:"openid-connect",level:3},{value:"Kubernetes OIDC",id:"kubernetes-oidc",level:3},{value:"Github \uc5f0\ub3d9\ud558\uae30",id:"github-\uc5f0\ub3d9\ud558\uae30",level:3},{value:"\uc815\ub9ac",id:"\uc815\ub9ac",level:3}],d={toc:p};function k(e){var n=e.components,c=(0,a.Z)(e,s);return(0,i.kt)("wrapper",(0,r.Z)({},d,c,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"dex---a-federated-openid-connect-provider"},"Dex - A federated OpenID Connect provider"),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"dex\ub294-\uae30\ubcf8\uc801\uc73c\ub85c-openid-connect\ub97c-\uc0ac\uc6a9\ud558\uc5ec-\ub2e4\ub978-\uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758-\uc778\uc99d\uc744-\ud558\uac8c-\ud574\uc8fc\ub294-identity-\uc11c\ube44\uc2a4\ub2e4"},"dex\ub294 \uae30\ubcf8\uc801\uc73c\ub85c OpenID Connect\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2e4\ub978 \uc560\ud50c\ub9ac\ucf00\uc774\uc158\uc758 \uc778\uc99d\uc744 \ud558\uac8c \ud574\uc8fc\ub294 identity \uc11c\ube44\uc2a4\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/coreos/dex"},"https://github.com/coreos/dex")),(0,i.kt)("p",null,'Dex\ub294 "connectors"\ub97c \ud1b5\ud574 \ub2e4\ub978 identity provider\uc758 \ud3ec\ud138(\uac8c\uc774\ud2b8\uc6e8\uc774, \uc911\uacc4\uc790) \uc5ed\ud560\uc744 \ud55c\ub2e4. \uc774\ub97c \ud1b5\ud574 LDAP, SAML\ub610\ub294 GitHub, Google, AD(Active Directory)\uc640 \uac19\uc740 \uae30\uc874 \uc778\uc99d\uc744 dex\uc5d0\uac8c \uc704\uc784\ud560 \uc218 \uc788\ub2e4. \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \uc77c\ub2e8 \uc778\uc99d \ub85c\uc9c1\uc744 \uc791\uc131\ud558\uc5ec dex\uc640 \ud1b5\uc2e0\ud558\uba74 dex\ub294 \uc8fc\uc5b4\uc9c4 \ubc31\uc5d4\ub4dc(\uc5ec\uae30\uc11c\ub294 \uc608\uc2dc\ub85c kubernetes \ud074\ub7ec\uc2a4\ud130)\uc5d0 \ub300\ud55c \ud504\ub85c\ud1a0\ucf5c\uc744 \ucc98\ub9ac\ud558\uac8c \ub41c\ub2e4. '),(0,i.kt)("p",null,"\ud558\uc9c0\ub9cc \ud5a5\ud6c4 Cloud Native \uc778\uc99d \uce74\ud0c8\ub85c\uadf8 \uc911 \ud558\ub098\ub85c\uc11c \uc0dd\uac01\ud558\uace0 \uc788\ub294 \uc624\ud508\uc18c\uc2a4\uc774\ub2e4 \ubcf4\ub2c8 \ud14c\uc2a4\ud2b8\ub294 \uc9c4\ud589\ud574\ubd10\uc57c \ud560 \uac83 \uac19\ub2e4."),(0,i.kt)("h3",{id:"openid-connect"},"OpenID Connect"),(0,i.kt)("p",null,"\uae30\ubcf8\uc801\uc73c\ub85c Dex\ub294 OIDC(OpenID Connect)\ub97c \uc0ac\uc6a9\ud55c\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uadf8\ub7ec\ubbc0\ub85c ",(0,i.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/access-authn-authz/authentication/#using-kubectl"},"kubernetes \ud074\ub7ec\uc2a4\ud130 \uc0ac\uc6a9\uc790 \uc778\uc99d\uc6a9\ub3c4"),"\ub85c Dex\ub97c \ubd99\uc77c\uc218 \uc788\ub294 \uac83\uc774\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\ub610\ud55c \uc704\uc5d0\uc11c \ub9d0\ud55c\uac83\uacfc \uac19\uc774 \ub2e4\ub978 identity provider\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc0ac\uc6a9\uc790\ub97c \uc778\uc99d\ud558\ub294\ub370 \uc544\ub798 \uadf8\ub9bc\uacfc \uac19\uc774 ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/coreos/dex#connectors"},"connectors"),"\ub97c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"dex_image",src:t(29301).Z,width:"760",height:"460"})),(0,i.kt)("p",null,'\uc704 \uadf8\ub9bc\uacfc \uac19\uc774 "connectors"\ub294 \ub2e4\ub978 identity provider\ub97c \ud1b5\ud574 \uc0ac\uc6a9\uc790\ub97c \uc778\uc99d\ud558\uae30 \uc704\ud574 dex\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 \uae30\ubcf8 \ub3c4\uad6c\ub2e4. \uacb0\uad6d Dex\ub294 \uae30\uc874\uc5d0 \ud65c\uc6a9\ud558\ub358 GitHub, LinkedIn \ubc0f Microsoft AD\uc640 \uac19\uc740 \ubca4\ub354 \ud50c\ub7ab\ud3fc\uc774\ub098 LDAP \ubc0f SAML\uacfc \uac19\uc740 \uae30\uc874 \ud504\ub85c\ud1a0\ucf5c \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud558\uc5ec kubernetes \ud074\ub7ec\uc2a4\ud130 \uc0ac\uc6a9\uc790 \uc778\uc99d\uc744 \uc27d\uac8c \uad6c\ud604\ud560 \uc218 \uc788\ub294 \uac83\uc774\ub2e4. \ud070 \ud68c\uc0ac??\ub4e4\uc740 OpenLDAP\uc774\ub098 Microsoft Active Directory\uc640 \uac19\uc740 \uc0ac\ub0b4 \ub514\ub809\ud1a0\ub9ac \uc11c\ube44\uc2a4\ub97c \uc6b4\uc6a9\ud558\uac70\ub098 \ub0b4\uac00 \uc788\ub294 \uc791\uc740 \uaddc\ubaa8\uc758 \ud300\ub4e4\uc740 \ub300\ubd80\ubd84 Github\uc774\ub098 Google \uacc4\uc815\uc740 \uac00\uc9c0\uace0 \uc788\uc744 \uac83\uc774\uae30 \ub54c\ubb38\uc5d0 Dex\uc640 \uac19\uc740 \uc624\ud508\uc18c\uc2a4\ub97c \uc0ac\uc6a9\ud568\uc73c\ub85c\uc368 \uae30\uc874 identity provider \uc640 kubernetes\ub97c \uc27d\uac8c \ud1b5\ud569\ud560 \uc218 \uc788\ub2e4\uace0 \ubcf8\ub2e4.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"dex_kube",src:t(8054).Z,width:"561",height:"321"})),(0,i.kt)("h3",{id:"kubernetes-oidc"},"Kubernetes OIDC"),(0,i.kt)("p",null,"\uc544\ub798 \uadf8\ub9bc\ucc98\ub7fc Identity Provider \uc704\uce58\uc5d0 Dex\ub97c \uad6c\uc131\ud558\uba74 \ub41c\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://d33wubrfki0l68.cloudfront.net/d65bee40cabcf886c89d1015334555540d38f12e/c6a46/img/docs/admin/k8s_oidc_login.svg",alt:"kube_openid"})),(0,i.kt)("p",null,"public managed kubernetes \ud658\uacbd\uc5d0\uc11c\ub294 \ud604\uc2e4\uc801\uc73c\ub85c kubeapi-server\ub97c \ucee8\ud2b8\ub864\ud558\uae30 \uc5b4\ub835\uae30 \ub54c\ubb38\uc5d0 \uc77c\ub2e8 Native \ud074\ub7ec\uc2a4\ud130\uc5d0 \uad6c\uc131\uc744 \ud558\ub3c4\ub85d \ud55c\ub2e4."),(0,i.kt)("h3",{id:"github-\uc5f0\ub3d9\ud558\uae30"},"Github \uc5f0\ub3d9\ud558\uae30"),(0,i.kt)("p",null,"\ud14c\uc2a4\ud2b8\ub85c Github\uc744 \uc5f0\ub3d9\ud574\ubcf4\uc790. \uc77c\ub2e8 \uc544\ub798\uc640 \uac19\uc774 \uc778\uc99d\uc11c\ub97c \uc0dd\uc131\ud558\ub294 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \ud558\ub098\ub9cc\ub4e0\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uc544\ub798\uc5d0\uc11c DNS.1 \ubd80\ubd84\uc740 /etc/hosts\ub85c \ud14c\uc2a4\ud2b8\ub85c \ub4f1\ub85d\ud560 \ub3c4\uba54\uc778\uc73c\ub85c \uac00\uc0c1\uc73c\ub85c \ub9cc\ub4e4\uc5c8\ub2e4. (generator.sh)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'#!/bin/bash\n\nmkdir -p ssl\n\ncat << EOF > ssl/req.cnf\n[req]\nreq_extensions = v3_req\ndistinguished_name = req_distinguished_name\n[req_distinguished_name]\n[ v3_req ]\nbasicConstraints = CA:FALSE\nkeyUsage = nonRepudiation, digitalSignature, keyEncipherment\nsubjectAltName = @alt_names\n[alt_names]\nDNS.1 = dex.newtech.academy\nEOF\n\nopenssl genrsa -out ssl/ca-key.pem 2048\nopenssl req -x509 -new -nodes -key ssl/ca-key.pem -days 10 -out ssl/ca.pem -subj "/CN=kube-ca"\n\nopenssl genrsa -out ssl/key.pem 2048\nopenssl req -new -key ssl/key.pem -out ssl/csr.pem -subj "/CN=kube-ca" -config ssl/req.cnf\nopenssl x509 -req -in ssl/csr.pem -CA ssl/ca.pem -CAkey ssl/ca-key.pem -CAcreateserial -out ssl/cert.pem -days 10 -extensions v3_req -extfile ssl/req.cnf\n')),(0,i.kt)("p",null,"Namespace\ub3c4 \ud558\ub098 \ub9cc\ub4e4\uc790. (dex-ns.yaml)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"apiVersion: v1\nkind: Namespace\nmetadata:\n  name: dex\n")),(0,i.kt)("p",null,"kubernetest \ud074\ub7ec\uc2a4\ud130\uc6a9 \uc778\uc99d\uc11c\ub97c \uc0dd\uc131\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ ./generator.sh\n$ kubectl create -f dex-ns.yaml\n$ kubectl create secret tls dex.newtech.academy.tls -n dex --cert=ssl/cert.pem --key=ssl/key.pem\n$ mkdir pki\n$ cp ssl/ca.pem pki/openid-ca.pem\n")),(0,i.kt)("p",null,"Github\uc5d0 \uac00\uc11c \uc544\ub798\uc640 \uac19\uc774 Org OAuth App.\uc744 \uc2e0\uaddc\ub85c \uc0dd\uc131\ud55c\ub2e4.  "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"github",src:t(49442).Z,width:"556",height:"407"})),(0,i.kt)("p",null,"\ub9cc\ub4e0 \uc704 \uc571\uc815\ubcf4\ub85c Github-Client Secret\uc744 \ub9cc\ub4e0\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ export GITHUB_CLIENT_ID=<Client ID>\n$ export GITHUB_CLIENT_SECRET=<Client Secret>\n\n$ kubectl create secret \\\n    generic github-client \\\n    -n dex \\\n    --from-literal=client-id=$GITHUB_CLIENT_ID \\\n    --from-literal=client-secret=$GITHUB_CLIENT_SECRET\n\n$ kubectl get secret\nNAME                  TYPE                                  DATA      AGE\ndefault-token-f29fb   kubernetes.io/service-account-token   3         27m\ndex.newtech.academy.tls    kubernetes.io/tls                     2         27m\ngithub-client         Opaque                                2         6s\n\n$ kubectl get secret github-client -o yaml\napiVersion: v1\ndata:\n  client-id: xxxxx\n  client-secret: xxxxxxx\nkind: Secret\nmetadata:\n  creationTimestamp: 2018-07-24T15:14:29Z\n  name: github-client\n  namespace: dex\n  resourceVersion: "7044721"\n  selfLink: /api/v1/namespaces/dex/secrets/github-client\n  uid: 42dfa0e9-8f54-11e8-8d6d-2aaad36eb114\ntype: Opaque\n')),(0,i.kt)("p",null,"\uc704\uc5d0\uc11c \uc774\uc57c\uae30 \ud588\uc9c0\ub9cc \uc5ec\uae30\uae4c\uc9c0 \uc544\ubb34\uc0dd\uac01\uc5c6\uc774 \ud37c\ube14\ub9ad\uc5d0\uc11c \uad6c\uc131\ud558\ub2e4\uac00 \uc0dd\uac01\ud574\ubcf4\ub2c8 kube-apiserver\ub97c \ubcc0\uacbd\ud558\ub824\uba74 \uc9c1\uc811 \ud074\ub7ec\uc2a4\ud130\ub97c \uc368\uc57c\ud55c\ub2e4\ub294 \uc774\ub7f0 \ubc14\ubcf4\uac19\uc740 \uc2e4\uc218\ub97c \ub610 \uc800\uc9c0\ub974\uace0 \ub9d0\uc558\ub2e4. \uadf8\ub798\uc11c \ub2e4\uc2dc VM\uc5d0 \uc7ac\uad6c\uc131\uc744 \u315c\u315c"),(0,i.kt)("p",null,"\uadf8\ub9ac\uace0 kube-apiserver manifest \ud30c\uc77c\uc5d0 \uc544\ub798 \ub0b4\uc6a9\uc744 \ucd94\uac00\ud55c\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","/etc/kubernetes/manifests/kube-apiserver.manifest"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"    - --oidc-issuer-url=https://dex.newtech.academy:32000\n    - --oidc-client-id=example-app\n    - --oidc-ca-file=/pki/openid-ca.pem\n    - --oidc-username-claim=email\n    - --oidc-groups-claim=groups\n")),(0,i.kt)("p",null,"\uadf8\ub9ac\uace0 kubelet \uc7ac\uc2dc\uc791\uc744 \ud55c\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ systemctl restart kubelet\n")),(0,i.kt)("p",null,"\ud14c\uc2a4\ud2b8\ub97c \uc704\ud574 dex sample app\uc744 \ube4c\ub4dc\ud558\uace0 \ub9cc\ub4e0 \uc778\uc99d\uc11c\uc640 \ud568\uaed8 \uc2e4\ud589\ud558\uac8c \ub418\uba74 \uc544\ub798\uc640 \uac19\uc774 \uc0d8\ud50c\ud398\uc774\uc9c0\ub97c \ubcfc\uc218 \uc788\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ sudo apt-get install make golang-1.9\n$ git clone https://github.com/coreos/dex.git\n$ cd dex\n$ git checkout v2.10.0\n$ export PATH=$PATH:/usr/lib/go-1.9/bin\n$ go get github.com/coreos/dex\n$ make bin/example-app\n$ export MY_IP=$(curl -s ifconfig.co)\n$ ./bin/example-app --issuer https://dex.newtech.academy:32000 --issuer-root-ca /pki/openid-ca.pem --listen http://${MY_IP}:5555 --redirect-uri http://${MY_IP}:5555/callback\n2018/07/25 14:37:52 listening on http://169.56.94.55:5555\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"dex_sample",src:t(60866).Z,width:"334",height:"181"})),(0,i.kt)("p",null,"\uadf8\ub9ac\uace0 \ub85c\uadf8\uc778\uc744 \ud558\uac8c \ub418\uba74 \uc544\ub798\uc640 \uac19\uc774 Github \uc778\uc99d\uc744 \ud1b5\ud574 kubernetes \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub824\uace0 \ud558\ub294 Token\uc744 \ud68d\ub4dd\ud560 \uc218 \uc788\ub2e4."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"kube_dex",src:t(8951).Z,width:"538",height:"657"})),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"dex_token",src:t(51508).Z,width:"686",height:"462"})),(0,i.kt)("p",null,"\ub2e4\uc74c\uc73c\ub85c \uc704\uc5d0\uc11c \ub9cc\ub4e0 token\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud574\uc11c Role, RoleBinding\uacfc \uc2e4\uc81c \ub85c\uadf8\uc778\ud560 github \uacc4\uc815\uc744 User\ub85c \uc0ac\uc6a9\ud558\ub3c4\ub85d \uc544\ub798\uc640 \uac19\uc774 \uc791\uc131\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'apiVersion: rbac.authorization.k8s.io/v1beta1\nkind: Role\nmetadata:\n  name: exampleUser\n  namespace: default\nrules:\n- apiGroups: [""] # "" indicates the core API group\n  resources: ["pods"]\n  verbs: ["get", "watch", "list"]\n---\napiVersion: rbac.authorization.k8s.io/v1beta1\nkind: RoleBinding\nmetadata:\n  name: exampleUser\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: exampleUser\nsubjects:\n- kind: User\n  name: ddiiwoong@gmail.com\n  namespace: default\n')),(0,i.kt)("p",null,"\uacc4\uc815\uc0dd\uc131\uc744 \ud558\uace0 \uc704\uc5d0\uc11c \ub9cc\ub4e0 token\uc744 \uac00\uc9c0\uace0 developer \uc0ac\uc6a9\uc790\ub97c \uc124\uc815\ud558\uace0 context\uc124\uc815\ub85c dev-default\ub85c \uc0dd\uc131\ud55c\ub2e4."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ kubectl create -f user.yaml\nrole.rbac.authorization.k8s.io "exampleUser" created\nrolebinding.rbac.authorization.k8s.io "exampleUser" created\n\n$ export TOKEN=<dex_sample_app_token>\n\n$ kubectl config set-credentials developer --auth-provider=oidc --auth-provider-arg=idp-issuer-url=https://dex.newtech.academy:32000 --auth-provider-arg=client-id=example-app --auth-provider-arg=idp-certificate-authority=/pki/openid-ca.pem  --auth-provider-arg=id-token=${TOKEN}\nUser "developer" set.\n\n$ kubectl config set-context dev-default --cluster=kubernetes --namespace=default --user=developer\nContext "dev-default" created.\n')),(0,i.kt)("p",null,"\uc704\ucc98\ub7fc \ub9cc\ub4e4\uace0 \ub098\uba74 \ud604\uc7ac \ud074\ub7ec\uc2a4\ud130\uc758 context\ub4e4\uc744 \ud655\uc778\ud560\uc218 \uc788\ub2e4. \ud655\uc778\ud6c4\uc5d0 context\ub97c dev-default\ub85c \ubc14\uafd4\ubcf4\uc790.",(0,i.kt)("br",{parentName:"p"}),"\n","\uc0c8\ub85c\uc6b4 context\ub97c \ud655\uc778\ud560\uc218 \uc788\ub2e4. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'$ kubectl config get-contexts\nCURRENT   NAME                  CLUSTER         AUTHINFO              NAMESPACE\n*         admin-cluster.local   cluster.local   admin-cluster.local   \n          dev-default           kubernetes      developer             default\n\n$ kubectl config use-context dev-default\nSwitched to context "dev-default".\n\n$ kubectl config get-contexts\nCURRENT   NAME                  CLUSTER         AUTHINFO              NAMESPACE\n          admin-cluster.local   cluster.local   admin-cluster.local   \n*         dev-default           kubernetes      developer             default\n\n$ kubectl get pod --all-namespaces\nNAMESPACE     NAME                                    READY     STATUS    RESTARTS   AGE\ndex           dex-64c4fb5b44-42d44                    1/1       Running   0          1h\ndex           dex-64c4fb5b44-r9p9d                    1/1       Running   0          1h\ndex           dex-64c4fb5b44-w5s2m                    1/1       Running   0          1h\nkube-system   calico-node-2bqll                       1/1       Running   0          13h\nkube-system   calico-node-cljb2                       1/1       Running   0          13h\nkube-system   calico-node-svh5n                       1/1       Running   0          13h\nkube-system   kube-apiserver-node1                    1/1       Running   0          1h\nkube-system   kube-controller-manager-node1           1/1       Running   2          13h\nkube-system   kube-dns-7bd4d5fbb6-7bb2j               3/3       Running   0          13h\nkube-system   kube-dns-7bd4d5fbb6-g8lz8               3/3       Running   0          13h\nkube-system   kube-proxy-node1                        1/1       Running   0          13h\nkube-system   kube-proxy-node2                        1/1       Running   0          13h\nkube-system   kube-proxy-node3                        1/1       Running   0          13h\nkube-system   kube-scheduler-node1                    1/1       Running   2          13h\nkube-system   kubedns-autoscaler-679b8b455-qxlvw      1/1       Running   0          13h\nkube-system   kubernetes-dashboard-55fdfd74b4-mbkm8   1/1       Running   0          13h\nkube-system   nginx-proxy-node2                       1/1       Running   0          13h\nkube-system   nginx-proxy-node3                       1/1       Running   0          13h\nkube-system   tiller-deploy-5c688d5f9b-52tls          1/1       Running   0          13h\n')),(0,i.kt)("h3",{id:"\uc815\ub9ac"},"\uc815\ub9ac"),(0,i.kt)("p",null,"\ucc98\uc74c\uc5d0\ub3c4 \uc5b8\uae09\ud588\ub4ef\uc774 kubernetes \uc778\uc99d\uc744 \uc704\ud574 \ubb34\uac70\uc6b4 keycloak\uc744 \uc0ac\uc6a9\uc744 \ud558\ub294 \uacbd\uc6b0\ub4e4\uc774 \ub9ce\uc740\ub370 \uac04\ub2e8\ud558\uac8c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 dex\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc5ec\ub7ec\uac00\uc9c0 identity provider\uc758 connector \uc5ed\ud560\ub85c \uc0ac\uc6a9\ud558\uae30\uc5d0\ub294 \ubb34\ub09c\ud55c\uac83 \uac19\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\uacb0\uad6d Dex\ub97c \uc774\uc6a9\ud558\uba74 GitHub\ub97c \ube44\ub86f\ud574 \ub2e4\uc591\ud55c OpenID, OAuth 2.0 \uc778\uc99d \uc11c\ube44\uc2a4\uc640 Kubernetes \ud074\ub7ec\uc2a4\ud130\ub97c \uc5ee\uae30 \uc26c\uc6b8\uc218 \uc788\ub2e4.",(0,i.kt)("br",{parentName:"p"}),"\n","\ub2e8, \ucd5c\uadfc commit\uc774 3-4\ub2ec\uc804\uc774\ub77c\ub294\uac83\uacfc \ucc98\uc74c stable helm\uc5d0 \ub4f1\ub85d\ub41c \ud6c4 \uc5c5\ub370\uc774\ud2b8\uac00 \uc5c6\uc5c8\ub2e4\ub294 \uc810\uc774 \uac71\uc815\ub418\ub294 \ubd80\ubd84\uc774\uae34 \ud558\ub2e4. (\ubb18\ud558\uac8c Redhat\uacfc \ud569\ubcd1 \uc77c\uc815\uc774 \uc624\ubc84\ub7a9 \ub418\uae34\ud55c\ub2e4...)"),(0,i.kt)("p",null,"\uac70\uc758 2\uc8fc\ub9cc\uc5d0 \ud3ec\uc2a4\ud305\uc778\ub370 '18 Google Next \ud0a4\ub178\ud2b8\uc5d0\uc11c ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/knative/"},"knative"),"\ub77c\ub294 \ud604\uc7ac \uac1c\ubc1c\uc911\uc778 \ud504\ub85c\uc81d\ud2b8\uc640 \uc720\uc0ac\ud55c \uc624\ud508\uc18c\uc2a4\uac00 \uacf5\uac1c\ub418\uc5c8\ub2e4. \ub2e4\uc74c\ubc88\uc5d4 knative\ub3c4 \ud55c\ubc88 \ud14c\uc2a4\ud2b8\ub97c \ud574\ubd10\uc57c \ud560\ub4ef \ud558\ub2e4. "),(0,i.kt)("p",null,"\ud37c\ube14\ub9ad\uacfc \ud504\ub77c\uc774\ube57 \ud074\ub7ec\uc2a4\ud130\uc5d0 \ub300\ud55c \uace0\ubbfc\uc774 \uc0dd\uae30\uae30 \uc2dc\uc791\ud55c\ub2e4. \ub2e4\uc2dc\uae08 \uc624\ud508\uc18c\uc2a4 \ud50c\ub7ab\ud3fc\uc5d0 \uc9d1\uc911\ud558\uae30 \uc704\ud574 \ud504\ub77c\uc774\ube57\uc73c\ub85c \ub3cc\uc544\uac00\uc57c \ud558\ub098\ub77c\ub294 \uace0\ubbfc\uc5d0\ub3c4 \ube60\uc838\uc788\ub294 \uc0c1\ud0dc\uc5d0\uc11c knative, GKE on Premise \uac19\uc740 \uc5d4\ud130\ud504\ub77c\uc774\uc988\uc5d0\uc11c \ud504\ub77c\uc774\ube57 \uad6c\ucd95\uc744 \uc704\ud55c \uac83\ub4e4\ub3c4 \ub098\uc624\uace0 \uc788\uc5b4\uc11c \ub354\ub354\uc6b1 \uace0\ubbfc\uc5d0 \ube60\uc9c4 \uc694\uc998\uc774\ub2e4..."))}k.isMDXComponent=!0},29301:function(e,n,t){n.Z=t.p+"assets/images/dex-flow-1eef87ca6cace19b3f458729579af0bd.png"},8054:function(e,n,t){n.Z=t.p+"assets/images/dex_architect-a6de41c76b10157ce30883eb12fec059.png"},49442:function(e,n,t){n.Z=t.p+"assets/images/dex_github-1ed6b600c442333faa787c6ced1743ff.png"},60866:function(e,n,t){n.Z=t.p+"assets/images/dex_sample-9a5c8b5247b98ec2212ebe08f1643d4b.png"},51508:function(e,n,t){n.Z=t.p+"assets/images/dex_token-4c8c3ec72343e5a92fc01a139b4e03e2.png"},8951:function(e,n,t){n.Z=t.p+"assets/images/kube_dex-ccd37f6afcbbc44fd31782cf20991954.png"}}]);